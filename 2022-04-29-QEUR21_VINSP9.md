## QEUR21_VINSP9: オリエンテーション ～ 旧プロジェクト技術明細書(畳み込みRT法_日本語版)

## ～　Feature Engineering　～

QEU:FOUNDER ： “せっかく、過去のプロジェクトの技術明細書をアップしているので「畳み込みRT(RT-Conv)」についても一応アップしておきたい。何はともあれ、「共有」って大切ね・・・(笑)。”

D先生 ： “FOUNDERの、その地道な姿勢が好感度高いです。特に自動検査機プロジェクトでは畳み込みRT法はよく使うと思うんですが、おそらく意味がよくわからないと思うんです。従来のRT法の考え方とコンセプトが全くちがうんで・・・。 “

QEU:FOUNDER ： “これ（畳み込みRT法）は「一種の」主成分です。”

D先生 ： “もっと良い表現があります。「Feature Engineering(特徴量エンジニアリング)」、FOUNDERの好きなこの人・・・。 “

(image2-10A-1)

QEU:FOUNDER ： “おおぉ・・・。大先生・・・。”

D先生 ： “この方は、特徴量エンジニアリングをこのように定義しています。“

What is Feature Engineering?
Here is how I define feature engineering:
Feature engineering is the process of transforming raw data into features that better represent the underlying problem to the predictive models, resulting in improved model accuracy on unseen data.
ここで、特徴量エンジニアリングの定義について説明します。
特徴量エンジニアリングとは、生データを、予測モデルにとって根本的な問題をよりよく表現する特徴に変換するプロセスであり、その結果、未知のデータに対するモデルの精度を向上させることができます。


QEU:FOUNDER ： “う～ん、よい定義だ。”

D先生 ： “我々の今回の立場からみて、こうも言っています。“

Better features means simpler models.
特徴量がよくなれば、モデルもシンプルになります。
With well engineered features, you can choose “the wrong parameters” (less than optimal) and still get good results, for much the same reasons. You do not need to work as hard to pick the right models and the most optimized parameters.
With good features, you are closer to the underlying problem and a representation of all the data you have available and could use to best characterize that underlying problem.
よく設計された特徴量では、「間違ったパラメータ」（最適ではない）を選択しても、ほとんど同じ理由で良い結果を得ることができます。正しいモデルや最適なパラメータを選択するために、それほど努力する必要はないのです。
優れた特徴量を使えば、より根本的な問題に近づくことができ、その根本的な問題を最もよく特徴付けるために利用可能なすべてのデータを表現することができます。


QEU:FOUNDER ： “まさしく、そう・・・。我々は畳み込みRT法メトリックスの力を借りてこそ、SVM程度の学習器でも外観検査自動機への「まな板」に上がっているんです。”

D先生 ： “最後に、畳み込みRT法メトリックスに関連して・・・。“

feature engineering is another topic which doesn’t seem to merit any review papers or books, or even chapters in books, but it is absolutely vital to ML success. […] Much of the success of machine learning is actually success in engineering features that a learner can understand.
特徴量エンジニアリングは、論文や書籍、あるいは書籍の章に値するとは思えないが、MLの成功には絶対不可欠なトピックです。(…中略）機械学習の成功の多くは、学習者が理解できるような特徴を設計することに成功しているのです。

— Scott Locklin, in “Neglected machine learning ideas”


QEU:FOUNDER ： “そりゃそうだ・・・。畳み込みRTメトリックスには方法論が決まっていません。課題のたびに、「アート(Art)」として柔軟に使えばいいのではと思っているんです。”

D先生 ： “今回のレポートは、我々が本メトリックスを提案した当初のレポートであることをお忘れなく・・・。”

## ～　本文　～

【背景技術】
【０００２】
コンピューターによる画像認識手法はAIコンテストなどを通じて新しい手法が次々と開発されており、最近ではﾃﾞｨｰﾌﾟﾗｰﾆﾝｸﾞが高性能な判別エンジンとして高く評価されています(図1)。


(図1:画像認識技術の変遷)

(image2-10A-2)

【０００３】
これらの高性能な画像認識技術は自然にある物体（例；イヌ、ネコ）などの微妙な特徴を判別する手法です。ただし、ユーザーが自由に設計した標識を判別する場合にはこのような複雑な手法は必要がありません。


(図2：標識の例)

(image2-10A-3)

【０００４】
標識の場合、最も重要な特徴は色の設計です。標識の色が異なると、その標識の意味が違うことが多くあります。それに対して、自然物の場合には形・パターンだけを注目するため白黒画像処理だけで判別ができます。


###【課題を解決するための手段】

【０００５】
本発明は品質改善に使用されているタグチメソッドの手法のひとつであるRT(Recognition Taguchi)法と畳み込み処理を併用して画像認識を行います。ここで本発明がいうところの画像認識とは、図3に示すように撮影した画像の中から指定した標識（ここでは白背景に赤色矢印）を検出することです。


（図3: 本発明の画像認識の考え方）

(image2-10A-4)

【０００６】
本発明と同様な技術シーズとして、顔や目の認識を行うために広く利用されているHAACASCADE技術があります（図4）。


（図4：HAACASCADE技術）

(image2-10A-5)

【０００７】
本発明とHAACASCADE技術の特徴を図5のように比較しました。本発明の長所はユーザが自分で設計した標識を簡単に識別できることです。


（図5：本発明とHAACASCADE法の比較）

(image2-10A-6)

【０００８】
本発明の外観検査自動機の解析フローを図6に示します。本発明は前半のデータの抽出と整形のためのユニット、後半の学習判別のためのユニットに分けられます。


（図6 ：本発明の解析ﾌﾛｰ[畳み込み+RTメトリックス]）

(image2-10A-7)

【０００９】
本発明が畳み込み処理で使用する8種の部品を図7、図8に示します。ここで、畳み込み用の部品はDATUM、LINE、BENDの3種に分類されています。「DATUM」は0次関数（縦横部品のクロス）として、「LINE」は1次関数、「BEND」は2次関数の検出用として設計されています。


(図7：畳み込み用部品その１)

(image2-10A-8)

(図8：畳み込み用部品その２)

(image2-10A-9)

【００１０】
円形の画像を上記の部品で畳み込み処理を行いヒートマップで可視化した結果を図9と図10に示します。


（図9 ： 円形画像の畳み込み結果：その１）

(image2-10A-10)

（図10 ： 円形画像の畳み込み結果：その２）

(image2-10A-11)

【００１１】
もう一つの例として、クロス形の画像で同様な処理を行った結果を図11と図12に示す。このように、被検査画像によって各部品で処理した結果は全く異なります。円形の場合には2次関数の成分が強く検出され、クロス形の場合には1次関数の成分が強く検出されます。


（図11 ： クロス画像の畳み込み結果：その１）

(image2-10A-12)

（図12 ： クロス画像の畳み込み結果：その２）

(image2-10A-13)

【００１２】
RT法は田口玄一が提案したタグチメソッドの一つであり、画像の認識でよく用いられる。その処理フローを図13に示します。


（図13 ：RT法の計算フロー）

(image2-10A-14)

【００１３】
RT法の概念モデル図を図14に示します。RT法は大量の情報（例：画像は数百万ピクセル）をY1（感度；一次関数成分）とY2（SN比：二次関数成分）の2種のメトリックスに縮約します。


（図14 ：RT法の解析モデル）

(image2-10A-15)

【００１４】
本発明が通常のRT法と異なる点は単位空間の定義です。通常のRT法では単位空間として、「検出したい均一なデータ群の代表的なデータ」を採用するのに対し、本発明では「0次関数の畳み込み結果」を採用します。これはRT法が単位空間（代表データ）と計測データの距離を計測するのに対し、本発明では0次成分をベースとして、変動の1次成分と2次成分を抽出するためです。そのため、本発明は距離による判別分析というより、主成分分析の一種と考えることができます。

画像判別アプリに搭載した判別ロジックの一例を図15に示します。本発明ではメトリックスが2種しかないため判定ロジックは極めて簡単です。サンプル画像の分析をしてメトリックスの変動範囲を決定し、IF文で判定してもよいです。もちろん、より高度なk近傍法やSVM,深層学習を使っても構いません。その場合、ユーザーに高度な知識が必要となります。



（図15 ：RT法のモデル）

(image2-10A-16)

## 【実施例-1】

【００１５】
本発明の画像認識法の特徴を理解するために計測する画像を種々に変更してRTメトリックスがどのように変化するかを実験しました (図16,17,18,19)。


（図16 : テスト画像その１）

(image2-10A-17)

（図17 : テスト画像その２）

(image2-10A-18)

（図18 : テスト画像その３）

(image2-10A-19)

（図19 : テスト画像その４）

(image2-10A-20)

【００１６】
この画像群からRTメトリックスのY1とY2で散布図を作成しました（図20）。本発明のメトリックスは画像の移動と回転には強く、変形と拡大縮小に弱いことがわかりました。


（図20 :　 Y1-Y2散布図）

(image2-10A-21)

【００１７】
このようなRTメトリックスの特性を鑑み、以下のような画像認識ロジックを設計しました。ロジック前半のデータ抽出・成形ユニットにより、輪郭検出とリサイズ機能で抽出画像の大きさが同じ程度になります。


（図6再掲 ：本発明の解析ﾌﾛｰ[畳み込み+RTメトリックス]）

(image2-10A-22)

## 【実施例-2】

【００１８】
本発明を適用した画像認識装置（PCアプリケーション）を作成しました。標識は自在に設計できるため、ここでは標識を以下のように作成しました(図20,21)。


（図20 : テスト画像その１）

(image2-10A-23)

（図21 : テスト画像その２）

(image2-10A-24)

【００１９】
円形のみの画像（図20）の画像抽出結果を図21に示します。この場合には標識の回転などの揺れによって抽出画像が安定しません。この場合には図22のように画像認識も安定しないこともあります。


（図21 :　「テスト画像その１」の画像抽出結果）

(image2-10A-25)

（図22:　「テスト画像その１」の画像抽出結果）

(image2-10A-26)

【００２０】
標識の設計を工夫した「テスト画像その２」を使用した場合には画像の抽出が安定します。さらに、本発明ではRGB値のユークリッド距離を使用することにより、必要な色の情報のみを抽出することができます（図24）。


（図23 :　「テスト画像その２」の画像抽出結果）

(image2-10A-27)

（図24:　「テスト画像その２」の画像抽出結果）

(image2-10A-28)

## 【産業上の利用可能性】

【００２１】
本発明を用いることにより、ユーザーが設計した標識や簡単な図形を識別し、機械による外観検査または走行などの自動化された行動を行うことができます。


【００２２】
ここまで、本発明の判別精度については論じませんでした。本発明の画像判別の精度は明らかに低いものの（図5）、それは問題ではありません。ユーザーが自分で任意に標識を設計できるため、判別精度が100％になる標識を使えばよいだけです。


（図5再掲：本発明とHAACASCADE法の比較）

(image2-10A-29)

【００２３】
本発明の最も重要なアドバンテージは色を画像認識に活用していることです。画像と形状を組み合わせれば、ユニークな標識を無限に生成できます。したがって、100％の判別精度を得ることは容易です。


(図2再掲：標識の例)

(image2-10A-30)

【００２３】
本発明の画像認識技術は非常に簡単です。必要とするコンピュータの必要スペックもワンボードコンピュータ（Raspberry Pi etc）で十分であり、学習のためにかかる時間もごくわずかでしょう。



```python

```
